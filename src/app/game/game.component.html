<div class="game-container">
  <!-- Game canvas -->
  <canvas id="myCanvas"></canvas>

  <!-- HUD TOP -->
  <div class="hud-top">
    <div class="hud-row hud-top-row">
      <div class="character-name">
        {{ character?.name }} <span class="lvl">Lv {{ character?.level }}</span>
      </div>

      <div class="hud-buttons">
        <div class="hud-button" (click)="openMap()">
          <img src="assets/ui/map.png" alt="Map" />
        </div>
        <div class="hud-button" (click)="openBackpack()">
          <img src="assets/ui/backpack.png" alt="Backpack" />
        </div>
        <div class="hud-button" (click)="openQuests()">
          <img src="assets/ui/quests.png" alt="Quests" />
        </div>
        <div class="hud-button" (click)="openSkills()">
          <img src="assets/ui/skills.png" alt="Skills" />
        </div>
        <div class="hud-button" (click)="openPauseMenu()">
          <img src="assets/ui/settings.png" alt="Settings" />
        </div>
      </div>
    </div>

    <div class="hud-row hud-bottom-row">
      <!-- Stats -->
      <div class="stats">
        <div class="stat">
          <img src="assets/ui/hp.png" alt="HP" />
          <span>{{ character?.hp }} / {{ character?.maxHp }}</span>
        </div>
        <div class="stat">
          <img src="assets/ui/mana.png" alt="MP" />
          <span>{{ character?.mp }} / {{ character?.maxMp }}</span>
        </div>
        <div class="stat">
          <img src="assets/ui/xp.png" alt="XP" />
          <span>{{ character?.xp }}</span>
        </div>
        <div class="stat">
          <img src="assets/ui/gold.png" alt="Gold" />
          <span>{{ character?.gold }}</span>
        </div>
      </div>

      <!-- Orbs (2x2) -->
      <div class="orbs-grid">
        @for (orb of orbs; track orb.name) {
          <div class="orb">
            <img [src]="orb.icon" [alt]="orb.name" />
            <span>{{ orb.value }}</span>
          </div>
        }
      </div>
    </div>
  </div>

  <div class="test-save-controls" style="position:absolute; top:12px; left:12px; z-index:9999;">
    <button (click)="saveMap()">Save map JSON</button>
    <label style="cursor:pointer;">
      Load map JSON
      <input type="file" accept="application/json" (change)="onLoadMapFile($event)" style="display:none;">
    </label>
  </div>

  <!-- HUD BOTTOM -->
  <div class="hud-bottom">
    <div class="tile-info">
      {{ currentTile?.description }}
    </div>

    <div class="overlay-actions">
      @for (action of actions; track action) {
        <button class="overlay-action" (click)="onAction(action)">{{ action }}</button>
      }
    </div>
  </div>

  <!-- Pause Menu Overlay -->
  @if (pauseMenuOpen) {
    <div class="pause-overlay">
      <div class="pause-menu">
        <h2>Pause</h2>
        <!-- <button (click)="closePauseMenu()">Continue</button>
        <button (click)="saveGameManual()">Save</button> -->
        <button (click)="goHome()">Back to home</button>
        <!-- <button (click)="quitGame()">Quit</button> -->
      </div>
    </div>
  }

</div>
