<!-- @if (character) { -->

<div class="game-container">
  <!-- Game canvas -->
  <canvas #gameCanvas id="myCanvas"></canvas>

  <!-- HUD TOP -->
  <div class="hud-top">
    <div class="hud-row hud-top-row">
      <div class="character-name">
        {{ character?.name }} <span class="lvl">Lv {{ character?.level }}</span>
      </div>

      <div class="hud-buttons">
        <div class="hud-button" (click)="openMap()">
          <img src="assets/ui/map.png" alt="Map" />
        </div>
        <div class="hud-button" (click)="openBackpack()">
          <img src="assets/ui/backpack.png" alt="Backpack" />
        </div>
        <div class="hud-button" (click)="openQuests()">
          <img src="assets/ui/quests.png" alt="Quests" />
        </div>
        <div class="hud-button" (click)="openSkills()">
          <img src="assets/ui/skills.png" alt="Skills" />
        </div>
        <div class="hud-button" (click)="openPauseMenu()">
          <img src="assets/ui/settings.png" alt="Settings" />
        </div>
      </div>
    </div>  

    <div class="hud-row hud-bottom-row">
      <!-- Stats -->
      <div class="stats">
        <div class="stat">
          <img src="assets/ui/hp.png" alt="HP" />
          <span>{{ character?.hp }} / {{ character?.maxHp }}</span>
        </div>
        <div class="stat">
          <img src="assets/ui/mana.png" alt="MP" />
          <span>{{ character?.mp }} / {{ character?.maxMp }}</span>
        </div>
        <div class="stat">
          <img src="assets/ui/xp.png" alt="XP" />
          <span>{{ character?.xp }}</span>
        </div>
        <div class="stat">
          <img src="assets/ui/gold.png" alt="Gold" />
          <span>{{ character?.gold }}</span>
        </div>
      </div>

      <!-- Orbs (2x2) -->
      <div class="orbs-grid">
        @for (orb of orbs; track orb.name) {
          <div class="orb">
            <img [src]="orb.icon" [alt]="orb.name" />
            <span>{{ orb.value }}</span>
          </div>
        }
      </div>
    </div>
  </div>

  <!-- HUD BOTTOM -->
  <div class="hud-bottom">
    <div class="tile-info">
      {{ currentTile?.description }}
    </div>
  </div>

  <!-- Map Menu Overlay -->
  @if (showMap) {
    <div class="map-overlay">
      <div class="map-parchment">
        <div class="map-header">
          <h2>World Map</h2>
          <button class="close-btn" (click)="showMap = false">âœ•</button>
        </div>
  
        <div class="map-body">
          <app-minimap [size]="900" [hexSize]="8"></app-minimap>
        </div>
  
        <div class="map-footer">
          <p>Move across the world to discover new lands and mysteries...</p>
        </div>
      </div>
    </div>
  }
  
  <!-- Pause Menu Overlay -->
  @if (pauseMenuOpen) {
    <div class="pause-overlay">
      <div class="pause-menu">
        <h2>Pause</h2>
        <button (click)="closePauseMenu()">Continue</button>
        <button (click)="saveGameManual()">Save Game</button>
        <button (click)="goHome()">Back to home</button>
        <!-- <button (click)="quitGame()">Quit Game</button> -->
      </div>
    </div>
  }

  @if (activeOverlay) {
    <app-overlay-window
      [kind]="activeOverlay.kind"
      [data]="activeOverlay"
      (close)="activeOverlay = null"
      (actionSelected)="onOverlayAction($event)">
    </app-overlay-window>
  }
   

</div>
